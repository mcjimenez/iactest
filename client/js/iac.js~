(function(imports) {
'use strict';
  var WHERE = 'testIAC';

  function connect() {
    navigator.mozApps.getSelf().onsuccess = function(evt) {
      var app = evt.target.result;
      if (app.connect) {
        app.connect(WHERE).then(function onConnAccepted(ports) {
          var msg = {
            txt: 'CJC test msg'
          };
          ports.forEach(port => {
            port.postMessage(msg);
            port.onmessage = function(evt) {
              console.log('CJC received:' + JSON.stringify(evt.data));
            };
          });
        }, function onConnRejected(reason) {
          console.log('CJC Cannot connect:' + reason);
        });
      }
    };

  }

  connect();

})(this);
